<h1 class="my-4 fw-bold">
  <% if @topic.nil? %>
    Все посты
  <% else %>
    <%= @topic.title %>
  <% end %>
</h1>

<!-- Создать пост -->
<div class="mb-4">
  <a href="/posts/new" class="btn btn-success">
    ➕ Создать пост
  </a>
</div>

<!-- Список постов -->
<% @posts.each do |post| %>
  <div class="card shadow-sm mb-4 border-0">
    <div class="card-body">
      <h3 class="card-title mb-3 fw-bold"><%= post.title %></h3>

      <p class="card-text text-secondary">
        <%= truncate(post.body, length: 200, omission: " ...") %>
      </p>

      <a href="/posts/<%= post.id %>" class="btn btn-primary">
        Читать дальше →
      </a>
    </div>

    <div class="card-footer bg-white text-muted small">
      Опубликовано: <%= post.created_at.strftime('%d.%m.%Y %H:%M') %>
    </div>
  </div>
<% end %>

<!-- Пагинация -->
<nav>
  <ul class="pagination justify-content-center mt-4">

    <li class="page-item <%= @has_newer ? '' : 'disabled' %>">
      <a class="page-link"
         href="/posts<%= @topic.present? ? '/' + @topic.alias : '' %>?newer=<%= @page_token %>">
        ← Новее
      </a>
    </li>

    <li class="page-item <%= @has_older ? '' : 'disabled' %>">
      <a class="page-link"
         href="/posts<%= @topic.present? ? '/' + @topic.alias : '' %>?older=<%= @page_token %>">
        Старее →
      </a>
    </li>

  </ul>
</nav>
<!-- Мельница + анимация букв -->
<div id="windmill-box" style="display:flex; align-items:center; gap:20px; margin-bottom:25px;">
  <!-- SVG мельницы -->
  <div id="windmill">
    <svg width="60" height="60" viewBox="0 0 100 100">
      <g transform="translate(50,50)">
        <polygon points="0,-40 10,-10 -10,-10" fill="#d9534f">
          <animateTransform
            attributeName="transform"
            type="rotate"
            from="0" to="360"
            dur="2s"
            repeatCount="indefinite" />
        </polygon>
        <polygon points="40,0 10,10 10,-10" fill="#5bc0de">
          <animateTransform attributeName="transform" type="rotate" from="0" to="360" dur="2s" repeatCount="indefinite" />
        </polygon>
        <polygon points="0,40 -10,10 10,10" fill="#5cb85c">
          <animateTransform attributeName="transform" type="rotate" from="0" to="360" dur="2s" repeatCount="indefinite" />
        </polygon>
        <polygon points="-40,0 -10,-10 -10,10" fill="#f0ad4e">
          <animateTransform attributeName="transform" type="rotate" from="0" to="360" dur="2s" repeatCount="indefinite" />
        </polygon>
      </g>
    </svg>
  </div>

  <!-- Логотип -->
  <div id="wind-text" style="font-size:32px; font-weight:700;">
    <span class="fly">М</span>
    <span class="fly">у</span>
    <span class="fly">р</span>
    <span class="fly">М</span>
    <span class="fly">у</span>
    <span class="fly">р</span>
  </div>
</div>

<style>
  #windmill-box { cursor: pointer; }

  .fly {
    display: inline-block;
    transition: transform 0.8s ease, opacity 0.8s ease;
  }

  .blown {
    transform: translateX(80px) translateY(-40px) rotate(30deg);
    opacity: 0;
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const letters = document.querySelectorAll(".fly");
    const box = document.getElementById("windmill-box");

    box.addEventListener("mouseenter", () => {
      letters.forEach((l, i) => {
        setTimeout(() => l.classList.add("blown"), i * 80);
      });
    });

    box.addEventListener("mouseleave", () => {
      letters.forEach((l, i) => {
        setTimeout(() => {
          l.classList.remove("blown");
        }, i * 80);
      });
    });
  });
</script>
